PYTHON_BUILD_FLAGS = `python-config --includes`
CC = gcc $(PYTHON_BUILD_FLAGS) -fpic $(INCL)
SWIG_PYTHON = swig -python -w462

all: _libcommands_py.so libcommands_py.py

COMMANDS=../src/commands.h

#the main python package file generated by SWIG from bind.swg
libcommands_py.py: commands.swg $(COMMANDS)
	$(SWIG_PYTHON) commands.swg

#the wrap file generated by SWIG from commands.swg
commands_wrap.c: commands.swg $(COMMANDS)
	$(SWIG_PYTHON) commands.swg 

#object file made by gcc via compiling of the wrap file
commands_wrap.o: commands_wrap.c
	$(CC) -c commands_wrap.c -o commands_wrap.o

#the binary code that is supposed to be loaded by libcommands_py.py
#it has _ in the beginning because libcommands_py.py file expects its existance
_libcommands_py.so: commands_wrap.o
	$(CC) -shared commands_wrap.o -o _libcommands_py.so

test: all
	python -c "import libcommands_py; print dir(libcommands_py); print 'Ok'"

clean:
	rm -f *.o _libcommands_py.so libcommands_py.py commands_wrap.c *.pyc
